{"version":3,"file":"baseProvider.cjs.js","mappings":";;UAAA;UACA;;;;;WCDA;WACA;WACA;WACA;WACA;WACA,iCAAiC,WAAW;WAC5C;WACA;;;;;WCPA;WACA;WACA;WACA;WACA,yCAAyC,wCAAwC;WACjF;WACA;WACA;;;;;WCPA;;;;;WCAA;WACA;WACA;WACA,uDAAuD,iBAAiB;WACxE;WACA,gDAAgD,aAAa;WAC7D;;;;;;;;;;;;;;;;ACNA,MAAM,8BAA4B;;;ACAlC,MAAM,2BAA4B;;;ACAlC,MAAM,qCAA4B;;;ACAlC,MAAM,wBAA4B;;;ACAlC,MAAM,yCAA4B;;;ACAlC,MAAM,mBAA4B;;;ACAlC,MAAM,8BAA4B;;;ACAlC,MAAM,8BAA4B;;;ACAlC,MAAM,gCAA4B;;ACAlC,MAAM,oBAA4B;;ACAlC,MAAM,uCAA4B;;;;;;;;;;;;;;ACAqG;AACzD;AACnC;AAcpC,IAAeI,YAAY;EAAA;EAAA;EAIhC;;EAGA,6BAAyD;IAAA;IAAA,IAA3CC,MAAM,SAANA,MAAM;MAAEC,KAAK,SAALA,KAAK;IAAA;IACzB,0BAAM;MAAED,MAAM,EAANA,MAAM;MAAEC,KAAK,EAALA;IAAM,CAAC;IAAE,yFAHoC,IAAI;IAIjE,IAAI,CAACD,MAAM,CAACE,WAAW,EAAE,MAAML,yEAAoD,CAAC,4BAA4B,CAAC;IACjH,IAAI,CAACG,MAAM,CAACE,WAAW,CAACE,OAAO,EAAE,MAAMP,yEAAoD,CAAC,2CAA2C,CAAC;IACxI,IAAI,CAACG,MAAM,CAACE,WAAW,CAACG,SAAS,EAAE,MAAMR,yEAAoD,CAAC,6CAA6C,CAAC;IAC5I,MAAKS,YAAY,GAAG;MAClBF,OAAO,EAAE;IACX,CAAM;IACN,MAAKG,aAAa,GAAG;MACnBL,WAAW,EAAEF,MAAM,CAACE,WAAW;MAC/BM,QAAQ,EAAE,6BAAGR,MAAM,CAACE,WAAW,CAACE,OAAO,EAAGJ,MAAM,CAACE,WAAW;IAC9D,CAAM;IACN;IAAmB;EACrB;EAAC;IAAA;IAAA,KAED,eAAgD;MAC9C,OAAO,IAAI,CAACO,oBAAoB;IAClC,CAAC;IAAA,KAED,aAAaC,CAAC,EAAE;MACd,MAAM,IAAIC,KAAK,CAAC,yBAAyB,CAAC;IAC5C;EAAC;IAAA;IAAA,OAED,kBAAgBT,WAA8B,EAAQ;MACpD,IAAI,CAACA,WAAW,CAACE,OAAO,EAAE,MAAMN,mEAA2B,CAAC,qBAAqB,CAAC;MAClF,IAAI,CAACI,WAAW,CAACG,SAAS,EAAE,MAAMP,mEAA2B,CAAC,qBAAqB,CAAC;MACpF,IAAI,CAACgB,SAAS,CAAC;QACbN,QAAQ,kCAAO,IAAI,CAACR,MAAM,CAACQ,QAAQ,oCAAGN,WAAW,CAACE,OAAO,EAAGF,WAAW;MACzE,CAAC,CAAM;IACT;EAAC;IAAA;IAAA,OAED,wBAAsBE,OAAe,EAA4B;MAAA;MAC/D,IAAMF,WAAW,4BAAG,IAAI,CAACF,MAAM,CAACQ,QAAQ,0DAApB,sBAAuBJ,OAAO,CAAC;MACnD,IAAI,CAACF,WAAW,EAAE,MAAMJ,oEAA4B,iBAAUM,OAAO,sDAAmD;MACxH,OAAOF,WAAW;IACpB;EAAC;IAAA;IAAA,OAED,kCAAoE;MAClE,OAAO,IAAI,CAACO,oBAAoB;IAClC;EAAC;IAAA;IAAA,OAED,mCAAoCO,mBAA6C,EAAE;MACjF,IAAI,IAAI,CAACP,oBAAoB,EAAE;QAC5B,IAAI,CAACA,oBAAoB,CAASQ,SAAS,CAACD,mBAAmB,CAAC;MACnE,CAAC,MAAM;QACL,IAAI,CAACP,oBAAoB,GAAGb,4DAAuB,CAA2BoB,mBAAmB,CAAC;MACpG;IACF;EAAC;EAAA;AAAA,EArDOrB,+CAAc;;ACjBxB,MAAM,gCAA4B;;;ACAlC,MAAM,2BAA4B;;;ACAlC,MAAM,8BAA4B;;;;;;;ACAkF;AAC+B;AAK5I,IAAM2B,wBAAwB;EAAA;IAAA;IAAA,uDAE4B,IAAI;EAAA;EAAA;IAAA;IAAA,KAEnE,eAAgD;MAC9C,OAAO,IAAI,CAACb,oBAAoB;IAClC,CAAC;IAAA,KAED,aAAaC,CAAC,EAAE;MACd,MAAM,IAAIC,KAAK,CAAC,yBAAyB,CAAC;IAC5C;EAAC;IAAA;IAAA,OAQD,kBAASD,CAAoB,EAAQ;MACnC,MAAM,IAAIC,KAAK,CAAC,yBAAyB,CAAC;IAC5C;EAAC;IAAA;IAAA;MAAA,yFAED,iBAA2BY,OAAe;QAAA;QAAA;UAAA;YAAA;cAAA;gBAClCC,iBAAiB,GAAG,IAAI,CAACC,oBAAoB,CAACF,OAAO,CAAC;gBACtDG,MAAM,GAAG,IAAIL,yCAAU,EAAE;gBAC/BK,MAAM,CAACC,IAAI,CAACH,iBAAiB,CAAC;gBACxBI,QAAQ,GAAGV,uDAAkB,CAACQ,MAAM,CAAC;gBAC3C,IAAI,CAACG,yBAAyB,CAACD,QAAQ,CAAC;cAAC;cAAA;gBAAA;YAAA;UAAA;QAAA;MAAA,CAC1C;MAAA;QAAA;MAAA;MAAA;IAAA;EAAA;IAAA;IAAA;MAAA,uFAED,kBAAyBlB,CAAsB;QAAA;UAAA;YAAA;cAAA;gBAAA,kCACtCoB,OAAO,CAACC,OAAO,EAAE;cAAA;cAAA;gBAAA;YAAA;UAAA;QAAA;MAAA,CACzB;MAAA;QAAA;MAAA;MAAA;IAAA;EAAA;IAAA;IAAA,OAED,kCAAoE;MAClE,OAAO,IAAI,CAACtB,oBAAoB;IAClC;EAAC;IAAA;IAAA,OAED,mCAAoCO,mBAA6C,EAAE;MACjF,IAAI,IAAI,CAACP,oBAAoB,EAAE;QAC5B,IAAI,CAACA,oBAAoB,CAASQ,SAAS,CAACD,mBAAmB,CAAC;MACnE,CAAC,MAAM;QACL,IAAI,CAACP,oBAAoB,GAAGb,4DAAuB,CAA2BoB,mBAAmB,CAAC;MACpG;IACF;EAAC;IAAA;IAAA,OAED,8BAA6BO,OAAe,EAAoC;MAC9E,IAAMS,UAAU,GAAG;QACjBC,aAAa;UAAA,yFAAE;YAAA;cAAA;gBAAA;kBAAA;oBAAA,kCACNV,OAAO;kBAAA;kBAAA;oBAAA;gBAAA;cAAA;YAAA;UAAA,CACf;UAAA;YAAA;UAAA;UAAA;QAAA;MACH,CAAC;MACD,OAAO,IAAI,CAACW,uBAAuB,CAACF,UAAU,CAAC;IACjD;EAAC;IAAA;IAAA,OAED,uCAAqF;MAAA,IAAnDC,aAAa,QAAbA,aAAa;MAAA,SAC9BE,oBAAoB;QAAA;MAAA;MAAA;QAAA,4FAAnC,kBAAoCzB,CAAwC,EAAE0B,GAA0B;UAAA;YAAA;cAAA;gBAAA;kBAAA;kBAAA,OACnFH,aAAa,EAAE;gBAAA;kBAAlCG,GAAG,CAACC,MAAM;gBAAA;gBAAA;kBAAA;cAAA;YAAA;UAAA;QAAA,CACX;QAAA;MAAA;MAED,OAAOjB,2DAAwB,CAAC;QAC9BkB,WAAW,EAAEnB,wDAAqB,CAACgB,oBAAoB;MACzD,CAAC,CAAC;IACJ;EAAC;EAAA;AAAA;AACF,yBAhEYb,wBAAwB;EAAA,gFAYC,kBAAOiB,MAA2B;IAAA;IAAA;MAAA;QAAA;UAAA;YAC9DC,eAAe,GAAG,IAAIlB,wBAAwB,EAAE;YAAA;YAAA,OAChDkB,eAAe,CAACC,aAAa,CAACF,MAAM,CAAChB,OAAO,CAAC;UAAA;YAAA,kCAC5CiB,eAAe;UAAA;UAAA;YAAA;QAAA;MAAA;IAAA;EAAA,CACvB;EAAA;IAAA;EAAA;AAAA;;ACtBH,MAAM,2CAA4B;;;ACAiB;AAC5C,IAAMG,cAAc,GAAGD,qCAAiB,EAAE;;ACDlB;AACY;AACX","sources":["webpack://@web3auth/base-provider/webpack/bootstrap","webpack://@web3auth/base-provider/webpack/runtime/compat get default export","webpack://@web3auth/base-provider/webpack/runtime/define property getters","webpack://@web3auth/base-provider/webpack/runtime/hasOwnProperty shorthand","webpack://@web3auth/base-provider/webpack/runtime/make namespace object","webpack://@web3auth/base-provider/external commonjs2 \"@babel/runtime/helpers/classCallCheck\"","webpack://@web3auth/base-provider/external commonjs2 \"@babel/runtime/helpers/createClass\"","webpack://@web3auth/base-provider/external commonjs2 \"@babel/runtime/helpers/assertThisInitialized\"","webpack://@web3auth/base-provider/external commonjs2 \"@babel/runtime/helpers/inherits\"","webpack://@web3auth/base-provider/external commonjs2 \"@babel/runtime/helpers/possibleConstructorReturn\"","webpack://@web3auth/base-provider/external commonjs2 \"@babel/runtime/helpers/get\"","webpack://@web3auth/base-provider/external commonjs2 \"@babel/runtime/helpers/getPrototypeOf\"","webpack://@web3auth/base-provider/external commonjs2 \"@babel/runtime/helpers/defineProperty\"","webpack://@web3auth/base-provider/external commonjs2 \"@toruslabs/base-controllers\"","webpack://@web3auth/base-provider/external commonjs2 \"@web3auth/base\"","webpack://@web3auth/base-provider/external commonjs2 \"eth-rpc-errors\"","webpack://@web3auth/base-provider/./src/baseProvider.ts","webpack://@web3auth/base-provider/external commonjs2 \"@babel/runtime/helpers/asyncToGenerator\"","webpack://@web3auth/base-provider/external commonjs2 \"@babel/runtime/regenerator\"","webpack://@web3auth/base-provider/external commonjs2 \"@toruslabs/openlogin-jrpc\"","webpack://@web3auth/base-provider/./src/commonPrivateKeyProvider.ts","webpack://@web3auth/base-provider/external commonjs2 \"json-rpc-random-id\"","webpack://@web3auth/base-provider/./src/utils.ts","webpack://@web3auth/base-provider/./src/index.ts"],"sourcesContent":["// The require scope\nvar __webpack_require__ = {};\n\n","// getDefaultExport function for compatibility with non-harmony modules\n__webpack_require__.n = (module) => {\n\tvar getter = module && module.__esModule ?\n\t\t() => (module['default']) :\n\t\t() => (module);\n\t__webpack_require__.d(getter, { a: getter });\n\treturn getter;\n};","// define getter functions for harmony exports\n__webpack_require__.d = (exports, definition) => {\n\tfor(var key in definition) {\n\t\tif(__webpack_require__.o(definition, key) && !__webpack_require__.o(exports, key)) {\n\t\t\tObject.defineProperty(exports, key, { enumerable: true, get: definition[key] });\n\t\t}\n\t}\n};","__webpack_require__.o = (obj, prop) => (Object.prototype.hasOwnProperty.call(obj, prop))","// define __esModule on exports\n__webpack_require__.r = (exports) => {\n\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n\t}\n\tObject.defineProperty(exports, '__esModule', { value: true });\n};","const __WEBPACK_NAMESPACE_OBJECT__ = require(\"@babel/runtime/helpers/classCallCheck\");","const __WEBPACK_NAMESPACE_OBJECT__ = require(\"@babel/runtime/helpers/createClass\");","const __WEBPACK_NAMESPACE_OBJECT__ = require(\"@babel/runtime/helpers/assertThisInitialized\");","const __WEBPACK_NAMESPACE_OBJECT__ = require(\"@babel/runtime/helpers/inherits\");","const __WEBPACK_NAMESPACE_OBJECT__ = require(\"@babel/runtime/helpers/possibleConstructorReturn\");","const __WEBPACK_NAMESPACE_OBJECT__ = require(\"@babel/runtime/helpers/get\");","const __WEBPACK_NAMESPACE_OBJECT__ = require(\"@babel/runtime/helpers/getPrototypeOf\");","const __WEBPACK_NAMESPACE_OBJECT__ = require(\"@babel/runtime/helpers/defineProperty\");","const __WEBPACK_NAMESPACE_OBJECT__ = require(\"@toruslabs/base-controllers\");","const __WEBPACK_NAMESPACE_OBJECT__ = require(\"@web3auth/base\");","const __WEBPACK_NAMESPACE_OBJECT__ = require(\"eth-rpc-errors\");","import { BaseConfig, BaseController, BaseState, createEventEmitterProxy, SafeEventEmitterProvider } from \"@toruslabs/base-controllers\";\nimport { CustomChainConfig, WalletInitializationError } from \"@web3auth/base\";\nimport { ethErrors } from \"eth-rpc-errors\";\n\nimport { IBaseProvider } from \"./IBaseProvider\";\n\nexport interface BaseProviderState extends BaseState {\n  chainId: string;\n}\n\nexport interface BaseProviderConfig extends BaseConfig {\n  chainConfig: Partial<CustomChainConfig>;\n  networks?: Record<string, CustomChainConfig>;\n  skipLookupNetwork?: boolean;\n}\n\nexport abstract class BaseProvider<C extends BaseProviderConfig, S extends BaseProviderState, P>\n  extends BaseController<C, S>\n  implements IBaseProvider<P>\n{\n  // should be Assigned in setupProvider\n  public _providerEngineProxy: SafeEventEmitterProvider | null = null;\n\n  constructor({ config, state }: { config: C; state?: S }) {\n    super({ config, state });\n    if (!config.chainConfig) throw WalletInitializationError.invalidProviderConfigError(\"Please provide chainConfig\");\n    if (!config.chainConfig.chainId) throw WalletInitializationError.invalidProviderConfigError(\"Please provide chainId inside chainConfig\");\n    if (!config.chainConfig.rpcTarget) throw WalletInitializationError.invalidProviderConfigError(\"Please provide rpcTarget inside chainConfig\");\n    this.defaultState = {\n      chainId: \"loading\",\n    } as S;\n    this.defaultConfig = {\n      chainConfig: config.chainConfig,\n      networks: { [config.chainConfig.chainId]: config.chainConfig },\n    } as C;\n    super.initialize();\n  }\n\n  get provider(): SafeEventEmitterProvider | null {\n    return this._providerEngineProxy;\n  }\n\n  set provider(_) {\n    throw new Error(\"Method not implemented.\");\n  }\n\n  public addChain(chainConfig: CustomChainConfig): void {\n    if (!chainConfig.chainId) throw ethErrors.rpc.invalidParams(\"chainId is required\");\n    if (!chainConfig.rpcTarget) throw ethErrors.rpc.invalidParams(\"chainId is required\");\n    this.configure({\n      networks: { ...this.config.networks, [chainConfig.chainId]: chainConfig },\n    } as C);\n  }\n\n  public getChainConfig(chainId: string): CustomChainConfig | null {\n    const chainConfig = this.config.networks?.[chainId];\n    if (!chainConfig) throw ethErrors.rpc.invalidRequest(`Chain ${chainId} is not supported, please add chainConfig for it`);\n    return chainConfig;\n  }\n\n  protected getProviderEngineProxy(): SafeEventEmitterProvider | null {\n    return this._providerEngineProxy;\n  }\n\n  protected updateProviderEngineProxy(providerEngineProxy: SafeEventEmitterProvider) {\n    if (this._providerEngineProxy) {\n      (this._providerEngineProxy as any).setTarget(providerEngineProxy);\n    } else {\n      this._providerEngineProxy = createEventEmitterProxy<SafeEventEmitterProvider>(providerEngineProxy);\n    }\n  }\n\n  abstract setupProvider(provider: P): Promise<void>;\n\n  abstract switchChain(params: { chainId: string }): Promise<void>;\n\n  protected abstract lookupNetwork(provider?: P): Promise<string | void>;\n}\n","const __WEBPACK_NAMESPACE_OBJECT__ = require(\"@babel/runtime/helpers/asyncToGenerator\");","const __WEBPACK_NAMESPACE_OBJECT__ = require(\"@babel/runtime/regenerator\");","const __WEBPACK_NAMESPACE_OBJECT__ = require(\"@toruslabs/openlogin-jrpc\");","import { createEventEmitterProxy, providerFromEngine, SafeEventEmitterProvider } from \"@toruslabs/base-controllers\";\nimport { createAsyncMiddleware, createScaffoldMiddleware, JRPCEngine, JRPCMiddleware, JRPCRequest, JRPCResponse } from \"@toruslabs/openlogin-jrpc\";\nimport { CustomChainConfig } from \"@web3auth/base\";\n\nimport { IBaseProvider } from \"./IBaseProvider\";\n\nexport class CommonPrivateKeyProvider implements IBaseProvider<string> {\n  // should be Assigned in setupProvider\n  public _providerEngineProxy: SafeEventEmitterProvider | null = null;\n\n  get provider(): SafeEventEmitterProvider | null {\n    return this._providerEngineProxy;\n  }\n\n  set provider(_) {\n    throw new Error(\"Method not implemented.\");\n  }\n\n  public static getProviderInstance = async (params: { privKey: string }): Promise<CommonPrivateKeyProvider> => {\n    const providerFactory = new CommonPrivateKeyProvider();\n    await providerFactory.setupProvider(params.privKey);\n    return providerFactory;\n  };\n\n  addChain(_: CustomChainConfig): void {\n    throw new Error(\"Method not implemented.\");\n  }\n\n  public async setupProvider(privKey: string): Promise<void> {\n    const privKeyMiddleware = this.getPrivKeyMiddleware(privKey);\n    const engine = new JRPCEngine();\n    engine.push(privKeyMiddleware);\n    const provider = providerFromEngine(engine);\n    this.updateProviderEngineProxy(provider);\n  }\n\n  public async switchChain(_: { chainId: string }): Promise<void> {\n    return Promise.resolve();\n  }\n\n  protected getProviderEngineProxy(): SafeEventEmitterProvider | null {\n    return this._providerEngineProxy;\n  }\n\n  protected updateProviderEngineProxy(providerEngineProxy: SafeEventEmitterProvider) {\n    if (this._providerEngineProxy) {\n      (this._providerEngineProxy as any).setTarget(providerEngineProxy);\n    } else {\n      this._providerEngineProxy = createEventEmitterProxy<SafeEventEmitterProvider>(providerEngineProxy);\n    }\n  }\n\n  private getPrivKeyMiddleware(privKey: string): JRPCMiddleware<unknown, unknown> {\n    const middleware = {\n      getPrivatekey: async (): Promise<string> => {\n        return privKey;\n      },\n    };\n    return this.createPrivKeyMiddleware(middleware);\n  }\n\n  private createPrivKeyMiddleware({ getPrivatekey }): JRPCMiddleware<unknown, unknown> {\n    async function getPrivatekeyHandler(_: JRPCRequest<{ privateKey: string }[]>, res: JRPCResponse<unknown>): Promise<void> {\n      res.result = await getPrivatekey();\n    }\n\n    return createScaffoldMiddleware({\n      private_key: createAsyncMiddleware(getPrivatekeyHandler),\n    });\n  }\n}\n","const __WEBPACK_NAMESPACE_OBJECT__ = require(\"json-rpc-random-id\");","import getCreateRandomId from \"json-rpc-random-id\";\nexport const createRandomId = getCreateRandomId();\n","export * from \"./baseProvider\";\nexport * from \"./commonPrivateKeyProvider\";\nexport * from \"./IBaseProvider\";\nexport * from \"./utils\";\n"],"names":["BaseController","createEventEmitterProxy","WalletInitializationError","ethErrors","BaseProvider","config","state","chainConfig","invalidProviderConfigError","chainId","rpcTarget","defaultState","defaultConfig","networks","_providerEngineProxy","_","Error","rpc","invalidParams","configure","invalidRequest","providerEngineProxy","setTarget","providerFromEngine","createAsyncMiddleware","createScaffoldMiddleware","JRPCEngine","CommonPrivateKeyProvider","privKey","privKeyMiddleware","getPrivKeyMiddleware","engine","push","provider","updateProviderEngineProxy","Promise","resolve","middleware","getPrivatekey","createPrivKeyMiddleware","getPrivatekeyHandler","res","result","private_key","params","providerFactory","setupProvider","getCreateRandomId","createRandomId"],"sourceRoot":""}