{"version":3,"file":"metadataHelpers.esm.js","sources":["../src/utils.ts","../src/MetadataStorageLayer.ts","../src/webAuthnShareResolver.ts"],"sourcesContent":[null,null,null],"names":["keccak256","a","createKeccakHash","update","digest","ec","EC","MetadataStorageLayer","constructor","metadataHost","arguments","length","undefined","serverTimeOffset","_defineProperty","setAPIKey","apiKey","setEmbedHost","embedHost","generateMetadataParams","message","privateKeyHex","key","keyFromPrivate","setData","data","timestamp","Math","floor","Date","now","toString","sig","sign","stringify","pub_key_X","getPublic","getX","pub_key_Y","getY","set_data","signature","Buffer","from","r","s","recoveryParam","padStart","slice","generatePubKeyParams","setMetadata","namespace","options","params","_objectSpread","metadataResponse","post","useAPIKey","getMetadata","pubKey","WEBAUTHN_TORUS_SHARE","WEBAUTHN_DEVICE_SHARE","encParamsHexToBuf","encParamsHex","iv","ephemPublicKey","ciphertext","mac","encParamsBufToHex","encParams","encryptData","privKeyHex","d","serializedDec","JSON","serializedBuf","encrypt","sData","decryptData","parse","keyPair","decrypt","getPrivate","getAndDecryptData","m","serializedData","encryptAndSetData","metadataParams","setTorusShare","webAuthnPubKey","webAuthnRefHex","subspace","subspaceData","refKeyPair","privKey","keyFromPublic","x","y","serializedSubspaceData","serializedSubspaceDataBuf","encSubspaceData","encSubspaceDataHex","setDeviceShare","getTorusShare","webAuthnKeyHex","getDeviceShare"],"mappings":"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"}